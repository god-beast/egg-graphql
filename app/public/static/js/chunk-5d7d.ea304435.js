(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-5d7d"],{"8b6L":function(e,t,s){"use strict";s.r(t);var a=s("gDS+"),n=s.n(a),i=s("FyfS"),r=s.n(i),o=s("QbLZ"),l=s.n(o),c=s("xEMq"),u=s("L2JU"),d={unread:"messageUnreadList",readed:"messageReadedList",trash:"messageTrashList"},g={name:"message_page",data:function(){return{listLoading:!0,contentLoading:!1,currentMessageType:"unread",messageContent:{content:{}}}},computed:l()({},Object(u.d)({messageUnreadList:function(e){return e.user.messageUnreadList},messageReadedList:function(e){return e.user.messageReadedList},messageTrashList:function(e){return e.user.messageTrashList},messageList:function(){return this[d[this.currentMessageType]]},titleClass:function(){return{"not-unread-list":"unread"!==this.currentMessageType}}}),Object(u.c)(["messageUnreadCount","messageReadedCount","messageTrashCount","userId"])),methods:l()({},Object(u.b)(["getMessageList","hasRead","removeReaded","restoreTrash"]),{stopLoading:function(e){this[e]=!1},handleSelect:function(e){this.messageContent={content:{}},this.currentMessageType=e},handleView:function(e){this.messageContent=this.messageList[e]},checkTask:function(){var e=!0,t=!1,s=void 0;try{for(var a,n=r()(this.messageContent.content.questionList);!(e=(a=n.next()).done);e=!0){if(0==a.value.result.length)return!1}}catch(e){t=!0,s=e}finally{try{!e&&n.return&&n.return()}finally{if(t)throw s}}return!0},submitTask:function(){var e=this;if(!this.checkTask())return this.$message({type:"error",message:"您还有题目未完成"}),!1;this.messageContent.status=1;var t=JSON.parse(n()(this.messageContent));t.content=n()(t.content),this.$confirm("确定提交任务?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){c.a.put(t).then(function(s){e.$message({type:"success",message:"成功提交"}),e.messageContent={content:{}},e.hasRead({taskId:t.taskId})})}).catch(function(){e.$message({type:"info",message:"已取消"})})},updateStatus:function(e,t){var s=this;c.a.put({userId:this.userId,taskId:t,status:e}).then(function(a){1==e?s.restoreTrash({taskId:t}):s.removeReaded({taskId:t}),s.messageContent={content:{}}})},removeMsg:function(e){e.loading=!0;var t=e._id;"readed"===this.currentMessageType?this.removeReaded({_id:t}):this.restoreTrash({_id:t})}}),mounted:function(){}},m=(s("F2W3"),s("KHd+")),p=Object(m.a)(g,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"message_main"},[s("el-card",{staticClass:"box-card"},[s("div",{staticClass:"message-page-con message-category-con"},[s("el-menu",{attrs:{width:"auto","default-active":"unread"},on:{select:e.handleSelect}},[s("el-menu-item",{attrs:{index:"unread"}},[s("template",{slot:"title"},[s("i",{staticClass:"el-icon-message"}),e._v(" "),s("span",{staticClass:"category-title"},[e._v("待处理")]),e._v(" "),s("el-badge",{staticStyle:{"margin-left":"10px"},attrs:{value:e.messageUnreadCount}})],1)],2),e._v(" "),s("el-menu-item",{attrs:{index:"readed"}},[s("template",{slot:"title"},[s("i",{staticClass:"el-icon-view"}),e._v(" "),s("span",{staticClass:"category-title"},[e._v("已完成")]),e._v(" "),s("el-badge",{staticStyle:{"margin-left":"10px"},attrs:{type:"info","class-name":"gray-dadge",value:e.messageReadedCount}})],1)],2),e._v(" "),s("el-menu-item",{attrs:{index:"trash"}},[s("template",{slot:"title"},[s("i",{staticClass:"el-icon-delete"}),e._v(" "),s("span",{staticClass:"category-title"},[e._v("回收站")]),e._v(" "),s("el-badge",{staticStyle:{"margin-left":"10px"},attrs:{type:"info","class-name":"gray-dadge",value:e.messageTrashCount}})],1)],2)],1)],1),e._v(" "),s("div",{staticClass:"message-page-con message-list-con"},[s("el-menu",{class:e.titleClass,attrs:{width:"auto","default-active":""},on:{select:e.handleView}},e._l(e.messageList,function(t,a){return s("el-menu-item",{key:"msg_"+t._id,attrs:{index:a+""}},[s("div",{staticClass:"msg-box"},[s("p",{staticClass:"msg-title"},[e._v(e._s(t.taskName))]),e._v(" "),s("div",[s("span",{staticClass:"msg-time"},[e._v(e._s(e._f("parseTime")(t.createTime,"{y}-{m}-{d}")))]),e._v(" "),"readed"==e.currentMessageType?s("i",{staticClass:"el-icon-delete",on:{click:function(s){e.updateStatus(2,t.taskId)}}}):e._e(),e._v(" "),"trash"==e.currentMessageType?s("i",{staticClass:"el-icon-back",on:{click:function(s){e.updateStatus(1,t.taskId)}}}):e._e()])])])}))],1),e._v(" "),e.messageContent.tag?s("div",{staticClass:"message-page-con message-view-con"},[s("div",{staticClass:"message-view-header"},[s("h2",{staticClass:"message-view-title"},[e._v(e._s(e.messageContent.taskName)+"\n          "),s("span",[e._v("--"+e._s(e.messageContent.tag[0]+"/"+e.messageContent.tag[1]+"版本调查")+" ")])])]),e._v(" "),s("ul",{staticClass:"mes-content-list"},e._l(e.messageContent.content.questionList,function(t,a){return s("li",{key:a,staticClass:"mes-content-single"},[s("el-tag",{staticClass:"mes-content-index"},[e._v(e._s(a+1))]),e._v(" "),s("h4",{staticClass:"mes-content-header"},[e._v("\n            "+e._s(t.question)+"\n          ")]),e._v(" "),1==t.type?s("el-radio-group",{model:{value:t.result,callback:function(s){e.$set(t,"result",s)},expression:"item.result"}},e._l(t.optionList,function(t,a){return s("el-radio",{key:a,attrs:{disabled:"unread"!=e.currentMessageType,value:t.questionOption,label:t.questionOption}})})):2==t.type?s("el-checkbox-group",{model:{value:t.result,callback:function(s){e.$set(t,"result",s)},expression:"item.result"}},e._l(t.optionList,function(t,a){return s("el-checkbox",{key:a,attrs:{disabled:"unread"!=e.currentMessageType,value:t.questionOption,label:t.questionOption}})})):3==t.type?s("el-input",{attrs:{disabled:"unread"!=e.currentMessageType,type:"textarea"},model:{value:t.result,callback:function(s){e.$set(t,"result",s)},expression:"item.result"}}):s("el-datePicker",{staticStyle:{width:"200px"},attrs:{type:"date",disabled:"unread"!=e.currentMessageType,placeholder:"选择时间"},model:{value:t.result,callback:function(s){e.$set(t,"result",s)},expression:"item.result"}})],1)})),e._v(" "),"unread"==e.currentMessageType?s("el-button",{attrs:{type:"primary"},on:{click:e.submitTask}},[e._v("提交")]):e._e()],1):e._e()])],1)},[],!1,null,null,null);p.options.__file="message.vue";t.default=p.exports},F2W3:function(e,t,s){"use strict";var a=s("jLnj");s.n(a).a},"gDS+":function(e,t,s){e.exports={default:s("oh+g"),__esModule:!0}},jLnj:function(e,t,s){},"oh+g":function(e,t,s){var a=s("WEpk"),n=a.JSON||(a.JSON={stringify:JSON.stringify});e.exports=function(e){return n.stringify.apply(n,arguments)}}}]);