(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-725a"],{"3Eti":function(t,e,i){},"7iH0":function(t,e,i){"use strict";i.r(e);var s=i("Ksg7"),n=function(t,e,i){return t[e]=t.splice(i,1,t[e])[0],t},o={"单选":1,"多选":2,"简答":3,"时间":4},a={data:function(){return{quesText:{1:"单选",2:"多选",3:"简答",4:"时间"},popSelect:"",typeOptions:[],quesTypeShow:!1,formItem:{id:"",title:"",status:"1",questionList:[]},isAdd:!1,addQuestionIndex:-1}},watch:{popSelect:function(){this.popSelect&&(this.addQues(o[this.popSelect]),this.quesTypeShow=!1)}},methods:{upQues:function(t){if(0===t)return!1;this.formItem.questionList=n(this.formItem.questionList,t,t-1)},downQues:function(t){if(t===this.formItem.questionList.length-1)return!1;this.formItem.questionList=n(this.formItem.questionList,t,t+1)},deleteQues:function(t){var e=this;if(1===this.formItem.questionList.length)return this.$message.warning("问卷至少需有一个问题！"),!1;this.$Modal.confirm({title:"删除该问题",content:"确定删除该问题？",onOk:function(){e.formItem.questionList.splice(t,1)}})},deleteOption:function(t,e){if(1===this.formItem.questionList[t].optionList.length)return this.$message.warning("该类问题至少需有一个选项！"),!1;this.formItem.questionList[t].optionList.splice(e,1)},addQuesBtn:function(t){this.quesTypeShow=!0,this.popSelect="",this.addQuestionIndex=t},addQues:function(t){var e={type:t,question:"",optionList:[{questionOption:""},{questionOption:""}]};3===t&&(e.optionList=[{questionOption:""}]),-1===this.addQuestionIndex?this.formItem.questionList.push(e):this.formItem.questionList.splice(this.addQuestionIndex+1,0,e)},addOption:function(t){this.formItem.questionList[t].optionList.push({questionOption:""})},saveAsNew:function(){var t=this;this.$confirm("确定另存为新问卷?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.save("new")}).catch(function(){t.$message({type:"info",message:"已取消"})})},save:function(t){var e=this;"new"===t&&delete this.formItem._id;var i=!0;return this.formItem.title?this.formItem.questionList.length<1?(this.$message.warning("问卷至少需有一个问题！"),!1):(this.formItem.questionList.forEach(function(s,n){if(s.sort=n,!s.question)return e.$message.warning("问题"+(n+1)+"的名称不能为空！"),i=!1,!1;if("new"===t&&(s.id=""),1===s.type||2===s.type)for(var o=0;o<s.optionList.length;o++){var a=s.optionList[o];a.sort=o,"new"===t&&(a.id="",a.questionId="");var r=o;if(!a.questionOption){4===s.type?e.$message.warning("问题"+(n+1)+"的子问题"+(r+1)+"的名称不能为空！"):e.$message.warning("问题"+(n+1)+"的选项"+(r+1)+"的名称不能为空！"),i=!1;break}}}),void(i&&(this.formItem._id?s.a.put(this.formItem).then(function(t){e.$message.success("编辑成功"),e.$router.push("/question/questionList")}).catch(function(t){console.log(t)}):s.a.create(this.formItem).then(function(t){e.$message.success("新增成功"),e.$router.push("/question/questionList")}).catch(function(t){console.log(t)})))):(this.$message.warning("问卷名称不能为空！"),!1)},getDetailInfo:function(t){var e=this;s.a.get({_id:t}).then(function(t){e.formItem=t.data[0]}).catch(function(t){})}},mounted:function(){var t=this.$route.query.id;"0"!==t&&t?(this.getDetailInfo(t),this.isAdd=!1):this.isAdd=!0}},r=(i("f6jC"),i("KHd+")),u=Object(r.a)(a,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"createQueTemp"},[i("el-form",{staticClass:"createQueTemp_form",attrs:{model:t.formItem,"label-width":"80px"}},[i("el-form-item",{attrs:{label:"问卷名称"}},[i("el-input",{attrs:{placeholder:"请输入问卷名称"},model:{value:t.formItem.title,callback:function(e){t.$set(t.formItem,"title","string"==typeof e?e.trim():e)},expression:"formItem.title"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"问卷状态"}},[i("el-radio-group",{model:{value:t.formItem.status,callback:function(e){t.$set(t.formItem,"status",e)},expression:"formItem.status"}},[i("el-radio",{attrs:{label:"1"}},[t._v("正常")]),t._v(" "),i("el-radio",{attrs:{label:"0"}},[t._v("禁用")])],1)],1),t._v(" "),i("div",{staticClass:"createQueTemp_ques_wrap"},[t._l(t.formItem.questionList,function(e,s){return i("div",{key:s,staticClass:"createQueTemp_per_ques"},[i("el-card",{staticClass:"box-card",staticStyle:{width:"100%"}},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("el-tag",{attrs:{type:"info"}},[t._v("问题"+t._s(s+1))]),t._v(" "),i("el-tag",{attrs:{type:""}},[t._v("("+t._s(t.quesText[e.type])+")")]),t._v(" "),i("div",{staticStyle:{float:"right"}},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){t.addQuesBtn(s)}}},[t._v("插入问题")]),t._v(" "),i("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(e){t.upQues(s)}}},[t._v("上移")]),t._v(" "),i("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(e){t.downQues(s)}}},[t._v("下移")]),t._v(" "),i("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){t.deleteQues(s)}}},[t._v("删除")])],1)],1),t._v(" "),i("div",{staticClass:"createQueTemp_per_ques_right"},[i("el-input",{staticStyle:{"margin-bottom":"20px"},attrs:{placeholder:"请输入问题名称"},model:{value:e.question,callback:function(i){t.$set(e,"question","string"==typeof i?i.trim():i)},expression:"item.question"}}),t._v(" "),4===e.type?i("div",[i("el-datePicker",{staticStyle:{width:"200px"},attrs:{type:"date",placeholder:"用户选择时间",disabled:""}})],1):t._l(e.optionList,function(n,o){return i("div",{key:o,staticClass:"createQueTemp_optionList"},[1===e.type?i("el-radio",{staticClass:"type-append",attrs:{disabled:"",value:!1}}):t._e(),t._v(" "),2===e.type?i("el-checkbox",{staticClass:"type-append",staticStyle:{"margin-right":"10px"},attrs:{disabled:""}}):t._e(),t._v(" "),3===e.type?i("el-input",{attrs:{placeholder:"用户输入框",disabled:""}}):[i("el-input",{attrs:{placeholder:"请输入"},model:{value:n.questionOption,callback:function(e){t.$set(n,"questionOption","string"==typeof e?e.trim():e)},expression:"option.questionOption"}}),t._v(" "),i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(e){t.deleteOption(s,o)}}})]],2)}),t._v(" "),1===e.type||2===e.type?i("el-button",{on:{click:function(e){t.addOption(s)}}},[t._v("添加选项")]):t._e()],2)])],1)}),t._v(" "),i("el-button",{staticClass:"createQueTemp_ques_wrap_add_btn",attrs:{type:"primary"},on:{click:function(e){t.addQuesBtn(-1)}}},[t._v("添加问题")])],2),t._v(" "),i("div",{staticStyle:{display:"flex","align-items":"center",width:"300px","margin-top":"40px"}},[i("el-button",{staticClass:"createQueTemp_save_btn",attrs:{type:"primary"},on:{click:t.save}},[t._v("保存")]),t._v(" "),t.isAdd?t._e():i("el-button",{staticClass:"createQueTemp_save_btn",attrs:{type:"warning"},on:{click:t.saveAsNew}},[t._v("另存模板")])],1)],1),t._v(" "),i("el-dialog",{attrs:{visible:t.quesTypeShow,width:"400px",title:"选择问题类型"},on:{"update:visible":function(e){t.quesTypeShow=e}}},[i("el-radio-group",{staticStyle:{margin:"0 auto",display:"block",width:"230px"},model:{value:t.popSelect,callback:function(e){t.popSelect=e},expression:"popSelect"}},[i("el-radio-button",{attrs:{label:"单选"}}),t._v(" "),i("el-radio-button",{attrs:{label:"多选"}}),t._v(" "),i("el-radio-button",{attrs:{label:"简答"}}),t._v(" "),i("el-radio-button",{attrs:{label:"时间"}})],1),t._v(" "),i("div",{attrs:{slot:"footer"},slot:"footer"})],1)],1)},[],!1,null,null,null);u.options.__file="createQuestion.vue";e.default=u.exports},Ksg7:function(t,e,i){"use strict";i.d(e,"a",function(){return n});var s=i("HB48").a.fetch,n={create:function(t){return s("post","/question",t)},get:function(t){return s("get","/question",t)},delete:function(t){return s("delete","/question",t)},put:function(t){return s("put","/question",t)}}},f6jC:function(t,e,i){"use strict";var s=i("3Eti");i.n(s).a}}]);
//# sourceMappingURL=chunk-725a.df17e2ee.js.map