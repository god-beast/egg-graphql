(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-b257"],{"/cXY":function(t,e,i){"use strict";var o=i("dyxB");i.n(o).a},BfOe:function(t,e,i){"use strict";i.r(e);var o=i("gDS+"),r=i.n(o),a=i("QbLZ"),n=i.n(a),l=i("L2JU"),s=i("HDHf"),c={data:function(){return{dialogFormVisible:!1,rules:{description:[{required:!0,message:"请填写BUG描述",trigger:"blur"}],reason:[{required:!0,message:"请填写产生原因",trigger:"blur"}],information:[{required:!0,message:"请选择修复情况",trigger:"blur"}]},form:{reportName:"",total:"0",closed:"0",remain:"0",probability:"99",new:"",change:"",important:"",bugList:[]},editData:{description:"",reason:"",information:""},id:null}},computed:n()({},Object(l.c)(["name","userId"])),created:function(){this.id=this.$route.query.id,this.id&&this.getData(this.id)},methods:{getData:function(t){var e=this;s.a.getOne({id:t}).then(function(t){e.form=t.data})},onSubmit:function(){var t=this;this.$confirm("确定发布?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){s.a.create(n()({},t.form,{name:t.name,userId:t.userId})).then(function(e){t.$message({type:"success",message:"发布成功"}),t.$router.push("/report/list")})}).catch(function(){t.$message({type:"info",message:"已取消"})})},addBug:function(){this.editData={},this.dialogFormVisible=!0},submitData:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return!1;e.form.bugList.push(JSON.parse(r()(e.editData))),e.dialogFormVisible=!1})},deleteBug:function(t,e){var i=this;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){i.form.bugList.splice(e,1)}).catch(function(){i.$message({type:"info",message:"已取消删除"})})}}},u=(i("/cXY"),i("KHd+")),m=Object(u.a)(c,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"report"},[i("el-form",{ref:"form",staticClass:"report_form",attrs:{model:t.form,"label-width":"100px"}},[i("el-form-item",{attrs:{label:"报告名称"}},[i("el-input",{staticStyle:{width:"400px"},model:{value:t.form.reportName,callback:function(e){t.$set(t.form,"reportName",e)},expression:"form.reportName"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"缺陷总数"}},[i("el-input-number",{attrs:{min:0},model:{value:t.form.total,callback:function(e){t.$set(t.form,"total",e)},expression:"form.total"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"已关闭缺陷数"}},[i("el-input-number",{attrs:{min:0},model:{value:t.form.closed,callback:function(e){t.$set(t.form,"closed",e)},expression:"form.closed"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"残留缺陷数"}},[i("el-input-number",{attrs:{min:0},model:{value:t.form.remain,callback:function(e){t.$set(t.form,"remain",e)},expression:"form.remain"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"解决率"}},[i("el-input",{staticStyle:{width:"150px"},model:{value:t.form.probability,callback:function(e){t.$set(t.form,"probability",e)},expression:"form.probability"}},[i("template",{slot:"append"},[t._v("%")])],2)],1),t._v(" "),i("el-form-item",{attrs:{label:"新增功能"}},[i("el-input",{staticStyle:{width:"800px"},attrs:{placeholder:"迭代新增功能点",type:"textarea",autosize:{minRows:6}},model:{value:t.form.new,callback:function(e){t.$set(t.form,"new",e)},expression:"form.new"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"修改模块"}},[i("el-input",{staticStyle:{width:"800px"},attrs:{placeholder:"开发重点修改的模块",type:"textarea",autosize:{minRows:6}},model:{value:t.form.change,callback:function(e){t.$set(t.form,"change",e)},expression:"form.change"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"重点测试"}},[i("el-input",{staticStyle:{width:"800px"},attrs:{placeholder:"需重点测试或可能会出现bug的地方",type:"textarea",autosize:{minRows:6}},model:{value:t.form.important,callback:function(e){t.$set(t.form,"important",e)},expression:"form.important"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"BUG汇总"}},[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.addBug}},[t._v("新增bug描述")]),t._v(" "),i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.form.bugList,border:""}},[i("el-table-column",{attrs:{prop:"description",label:"BUG描述"}}),t._v(" "),i("el-table-column",{attrs:{prop:"reason",label:"产生原因"}}),t._v(" "),i("el-table-column",{attrs:{prop:"information",label:"修复情况"}}),t._v(" "),i("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(i){t.deleteBug(e.row,e.$index)}}},[t._v("删除")])]}}])})],1)],1),t._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("立即创建")]),t._v(" "),i("el-button",[t._v("取消")])],1)],1),t._v(" "),i("el-dialog",{attrs:{width:"600px",title:"新增/编辑",visible:t.dialogFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[i("el-form",{ref:"dataForm",staticStyle:{width:"400px","margin-left":"50px"},attrs:{rules:t.rules,model:t.editData,"label-position":"left","label-width":"90px"}},[i("el-form-item",{attrs:{label:"BUG描述",prop:"description"}},[i("el-input",{model:{value:t.editData.description,callback:function(e){t.$set(t.editData,"description",e)},expression:"editData.description"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"产生原因",prop:"reason"}},[i("el-input",{model:{value:t.editData.reason,callback:function(e){t.$set(t.editData,"reason",e)},expression:"editData.reason"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"修复情况",prop:"information"}},[i("el-input",{model:{value:t.editData.information,callback:function(e){t.$set(t.editData,"information",e)},expression:"editData.information"}})],1)],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitData("dataForm")}}},[t._v("确定")])],1)],1)],1)},[],!1,null,"2161b56c",null);m.options.__file="create.vue";e.default=m.exports},HDHf:function(t,e,i){"use strict";i.d(e,"a",function(){return r});var o=i("HB48").a.fetch,r={create:function(t){return o("post","/report",t)},get:function(t){return o("get","/report",t)},getOne:function(t){return o("get","/oneReport",t)},delete:function(t){return o("delete","/report",t)},update:function(t){return o("put","/report",t)}}},dyxB:function(t,e,i){},"gDS+":function(t,e,i){t.exports={default:i("oh+g"),__esModule:!0}},"oh+g":function(t,e,i){var o=i("WEpk"),r=o.JSON||(o.JSON={stringify:JSON.stringify});t.exports=function(t){return r.stringify.apply(r,arguments)}}}]);